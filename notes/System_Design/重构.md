[toc]

## 1. 重构是什么

在不改变代码外在行为的前提下，对代码做出修改，以改进程序的内部结构。本质上来说，重构就是在代码写好之后改进它的设计。

## 2. 什么时候需要重构
维护的系统有很多想吐槽的地方或者痛点，这时就需要重构


## 3. 如何重构旧系统
### 3.1. 梳理业务流程
体验业务/历史需求单/原型图
一个tag一个tag的看
自上而下：抓包看接口，从接口下去
自下而上：整理数据表之间的关系
把代码翻译成人话
加debug日志一点点试逻辑.
培养新人 得告诉他具体怎么改 梳理文档
屡清楚之后faq，开会对清楚
### 3.2. 梳理架构
服务与服务之间的调用关系
基础服务、业务服务、外部服务三层

### 3.3. 梳理问题
- 注释特别多
- 某个函数或者类职责太多
- 重复代码
### 3.4. 解决问题


## 4. 模式
### 4.1. 绞杀者模式
![重构-绞杀者模式](https://raw.githubusercontent.com/TDoct/images/master/1647919980_20220322112411360_10552.png)
### 4.2. 防腐层模式
![重构-防腐层模式](https://raw.githubusercontent.com/TDoct/images/master/1647919978_20220322110104263_3170.png)

## 5. 参考
- [重构（一）对重构的理解 \- 简书](https://www.jianshu.com/p/5102d0d5e8d0)
- [【重构系列】什么时候需要进行代码重构？ \- 掘金](https://juejin.im/post/5d6695f051882554e26201d2)
- [快速熟悉业务和代码](https://maimai.cn/web/gossip_detail?gid=29195251&egid=af767ab1e91411eb82e4801844e2d86c)
- [大家写业务代码有什么心得吗？ \- V2EX](https://www.v2ex.com/t/715159)